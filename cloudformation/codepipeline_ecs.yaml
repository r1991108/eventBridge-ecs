AWSTemplateFormatVersion: "2010-09-09"

Description: Template generated by rain

Resources:
  MyPipeline:
    Type: AWS::CodePipeline::Pipeline
    Properties:
      ArtifactStore: # Optional
#        EncryptionKey: # Optional
#          Id: CHANGEME
#          Type: CHANGEME
        Location: "codepipeline-ap-northeast-1-376705332781"
        Type: "S3"
#      ArtifactStores:
#        - ArtifactStore:
#            EncryptionKey: # Optional
#              Id: CHANGEME
#              Type: CHANGEME
#            Location: CHANGEME
#            Type: CHANGEME
#          Region: CHANGEME
#      DisableInboundStageTransitions:
#        - Reason: CHANGEME
#          StageName: CHANGEME
      Name: "apitest-codepipeline-ecs" # Optional
      RestartExecutionOnUpdate: false # Optional
      RoleArn: "arn:aws:iam::189388601959:role/service-role/AWSCodePipelineServiceRole-ap-northeast-1-apitest"
      Stages:
        # Source
        - Actions:
            - ActionTypeId:
                Category: "Source"
                Owner: "AWS"
                Provider: "CodeStarSourceConnection"
                Version: "1"
              Configuration: 
                BranchName: "main"
                ConnectionArn: "arn:aws:codestar-connections:ap-northeast-1:189388601959:connection/b0af80d1-5061-4485-ae2d-7eff3330a6be"
                FullRepositoryId: "r1991108/eventBridge-ecs"
                OutputArtifactFormat: "CODE_ZIP" # Optional
#              InputArtifacts: # Optional
#                - Name: CHANGEME
              Name: "Source"
              Namespace: "SourceVariables" # Optional
              OutputArtifacts: # Optional
                - Name: "SourceArtifact"
              Region: "ap-northeast-1" # Optional
#              RoleArn: CHANGEME # Optional
              RunOrder: 1 # Optional
#          Blockers: # Optional
#            - Name: CHANGEME
#              Type: CHANGEME
          Name: "Source"
        # Build
        - Actions:
            - ActionTypeId:
                Category: "Build"
                Owner: "AWS"
                Provider: "CodeBuild"
                Version: "1"
              Configuration: 
                ProjectName: "apitest" # Optional
              InputArtifacts: # Optional
                - Name: "SourceArtifact"
              Name: "Build"
              Namespace: "BuildVariables" # Optional
              OutputArtifacts: # Optional
                - Name: "BuildArtifact"
              Region: "ap-northeast-1" # Optional
#              RoleArn: CHANGEME # Optional
              RunOrder: 1 # Optional
#          Blockers: # Optional
#            - Name: CHANGEME
#              Type: CHANGEME
          Name: "Build"
        # Deploy
        - Actions:
            - ActionTypeId:
                Category: "Deploy"
                Owner: "AWS"
                Provider: "ECS"
                Version: "1"
              Configuration: 
                ClusterName: "testapi"
                ServiceName: "apitest" # Optional
              InputArtifacts: # Optional
                - Name: "BuildArtifact"
              Name: "Deploy"
              Namespace: "DeployVariables" # Optional
#              OutputArtifacts: # Optional
#                - Name: "SourceArtifact"
              Region: "ap-northeast-1" # Optional
#              RoleArn: CHANGEME # Optional
              RunOrder: 1 # Optional
#          Blockers: # Optional
#            - Name: CHANGEME
#              Type: CHANGEME
          Name: "Deploy"
#      Tags:
#        - Key: CHANGEME
#          Value: CHANGEME

#Outputs:
#  MyPipelineVersion:
#    Value: !GetAtt MyPipeline.Version

